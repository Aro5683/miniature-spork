<!DOCTYPE html>
<html>
<body>
<h2>Encrypt PDF for Offline Viewer</h2>
<input type="file" id="pdfFile">
<button onclick="encryptPDF()">Encrypt</button>

<textarea id="output" style="width:100%;height:200px;margin-top:20px;"></textarea>

<script>
const SECRET_KEY = "MY_PRIVATE_SECRET_2025";

async function encryptPDF(){

  const file = document.getElementById("pdfFile").files[0];
  if(!file){ alert("Upload PDF"); return; }

  const pdfBuffer = await file.arrayBuffer();

  const keyMaterial = await crypto.subtle.digest(
    "SHA-256",
    new TextEncoder().encode(SECRET_KEY)
  );

  const key = await crypto.subtle.importKey(
    "raw",
    keyMaterial,
    {name:"AES-GCM"},
    false,
    ["encrypt"]
  );

  const iv = crypto.getRandomValues(new Uint8Array(12));

  const encrypted = await crypto.subtle.encrypt(
    {name:"AES-GCM",iv},
    key,
    pdfBuffer
  );

  const combined = new Uint8Array(iv.length + encrypted.byteLength);
  combined.set(iv);
  combined.set(new Uint8Array(encrypted), iv.length);

  const base64 = btoa(String.fromCharCode(...combined));

  document.getElementById("output").value = base64;
}
</script>
</body>
</html>
